Perfect—here’s a **single-drop** replacement for your `CopilotPanel.tsx` that includes the “Nicer UI” (pagination, readable table) **and** a compact **Summary of Findings** card (badges + bullet points) rendered from `meta.summary`.

> Drop this in at `web/components/CopilotPanel.tsx`.

```tsx
import React, { useState } from "react";

/**
 * CopilotPanel
 * - Real pagination (limit/offset) + quick page-size buttons
 * - Readable numeric formatting + status/level badges
 * - Summary of Findings card under the table (uses meta.summary from /copilot/ask)
 * - Works with tools: smokeTest, getAgentSummaries, listRoles, getRoleByHandle
 */

type TableOut = {
  type: "table";
  columns: string[];
  rows: any[][];
  meta?: {
    count?: number;
    total?: number;
    diagnostics?: string[];
    summary?: {
      overall?: string;
      stats?: { avg_success_pct?: number | string; avg_p95_s?: number | string; median_cost_usd?: number | string };
      buckets?: { low?: number; medium?: number; high?: number };
      top_risks?: { name: string; why: string }[];
      next_actions?: string[];
    };
  };
};

type SmokeOut = {
  result: string; // "Green" | "Amber"
  diagnostics: Record<string, any>;
  summary?: string; // "PASS …" / "FAIL …"
};

type JsonOut = { type: "json"; item: unknown };

type AnyOut = TableOut | SmokeOut | JsonOut | null;

async function postAsk(tool: string, params: any = {}) {
  const r = await fetch("/copilot/ask", {
    method: "POST",
    headers: { "content-type": "application/json" },
    body: JSON.stringify({ tool, params }),
  });
  if (!r.ok) throw new Error(`HTTP ${r.status}`);
  return r.json();
}

const nf = new Intl.NumberFormat(undefined, { maximumFractionDigits: 3 });
function fmtNum(v: any) {
  if (v === "—" || v === null || v === undefined || Number.isNaN(Number(v))) return "—";
  return nf.format(Number(v));
}
function isNumberLike(v: any) {
  return v !== "—" && v !== null && v !== undefined && Number.isFinite(Number(v));
}

function Badge({ children, tone = "default" }: { children: React.ReactNode; tone?: "default" | "green" | "amber" | "red" | "blue" }) {
  const map: Record<string, string> = {
    default: "border text-gray-700 bg-white",
    green: "border-green-300 text-green-800 bg-green-50",
    amber: "border-amber-300 text-amber-800 bg-amber-50",
    red: "border-rose-300 text-rose-800 bg-rose-50",
    blue: "border-blue-300 text-blue-800 bg-blue-50",
  };
  return <span className={`px-2 py-0.5 rounded-full text-xs ${map[tone]} border`}>{children}</span>;
}

function SummaryCard({ meta }: { meta?: TableOut["meta"] }) {
  if (!meta?.summary) return null;
  const s = meta.summary;
  const low = s.buckets?.low ?? 0;
  const med = s.buckets?.medium ?? 0;
  const high = s.buckets?.high ?? 0;

  return (
    <div className="mt-3 rounded-xl border p-3 space-y-2">
      <div className="flex flex-wrap items-center gap-2">
        <strong>Summary of Findings</strong>
        <div className="flex items-center gap-1">
          <Badge tone="green">Low {low}</Badge>
          <Badge tone="amber">Medium {med}</Badge>
          <Badge tone="red">High {high}</Badge>
        </div>
      </div>

      {s.overall ? <div className="text-sm text-gray-800">{s.overall}</div> : null}

      {s.stats && (
        <div className="text-sm text-gray-700">
          <b>Key stats:</b>{" "}
          avg success {isNumberLike(s.stats.avg_success_pct) ? `${s.stats.avg_success_pct}%` : "—"} · p95{" "}
          {isNumberLike(s.stats.avg_p95_s) ? `${s.stats.avg_p95_s}s` : "—"} · median cost $
          {isNumberLike(s.stats.median_cost_usd) ? s.stats.median_cost_usd : "—"}
        </div>
      )}

      {!!(s.top_risks && s.top_risks.length) && (
        <div className="text-sm">
          <b>Top risks:</b>
          <ul className="list-disc pl-5 mt-1">
            {s.top_risks.slice(0, 5).map((r, i) => (
              <li key={i}>
                <span className="font-medium">{r.name}</span> — {r.why || "needs review"}
              </li>
            ))}
          </ul>
        </div>
      )}

      {!!(s.next_actions && s.next_actions.length) && (
        <div className="text-sm">
          <b>Next actions:</b>
          <ul className="list-disc pl-5 mt-1">
            {s.next_actions.map((a, i) => (
              <li key={i}>{a}</li>
            ))}
          </ul>
        </div>
      )}

      {!!(meta.diagnostics && meta.diagnostics.length) && (
        <div className="text-xs text-amber-700">
          Diagnostics: {meta.diagnostics.join("; ")}
        </div>
      )}
    </div>
  );
}

export default function CopilotPanel({ admin = false, gptUrl }: { admin?: boolean; gptUrl?: string }) {
  const [out, setOut] = useState<AnyOut>(null);
  const [err, setErr] = useState<string | null>(null);
  const [limit, setLimit] = useState<number>(10);
  const [offset, setOffset] = useState<number>(0);

  const run = async (tool: string, params: Record<string, any> = {}) => {
    setErr(null);
    const data = await postAsk(tool, params);
    setOut(data);
    return data;
  };

  // Convenience fetchers for agent/role lists that manage limit/offset UI state
  const fetchAgents = async (nextOffset = offset, nextLimit = limit, extra: any = {}) => {
    await run("getAgentSummaries", { limit: nextLimit, offset: nextOffset, ...extra });
    setLimit(nextLimit);
    setOffset(nextOffset);
  };
  const fetchRoles = async (nextOffset = offset, nextLimit = limit) => {
    await run("listRoles", { limit: nextLimit, offset: nextOffset });
    setLimit(nextLimit);
    setOffset(nextOffset);
  };

  // Derived pagination flags from table meta
  const meta = (out as TableOut)?.meta;
  const total = Number(meta?.total ?? 0);
  const canPrev = offset > 0;
  const canNext = offset + limit < total;

  // Table renderer with better alignment + badges
  const renderTable = (payload: TableOut) => {
    const numericCols = new Set(["success_pct", "p95_s", "cost_usd", "next_gate"]);
    return (
      <div className="overflow-auto">
        <table className="min-w-full text-sm">
          <thead>
            <tr>
              {payload.columns.map((c) => (
                <th
                  key={c}
                  className={`p-2 border-b ${numericCols.has(c) ? "text-right" : "text-left"}`}
                >
                  {c}
                </th>
              ))}
            </tr>
          </thead>
          <tbody>
            {payload.rows.map((row, i) => {
              // Expect: [name, autonomy_level, status, next_gate, success_pct, p95_s, cost_usd]
              const [name, level, status, next_gate, success_pct, p95_s, cost_usd] = row;
              const isAgentsTable = payload.columns.includes("autonomy_level");
              return (
                <tr key={i} className="align-middle">
                  <td className="p-2 border-b">{String(name)}</td>
                  <td className="p-2 border-b">
                    {isAgentsTable ? <Badge tone="blue">{String(level)}</Badge> : String(level)}
                  </td>
                  <td className="p-2 border-b">
                    <Badge tone={status === "live" ? "green" : status === "pilot" ? "amber" : "default"}>
                      {String(status)}
                    </Badge>
                  </td>
                  <td className="p-2 border-b text-right">{fmtNum(next_gate)}</td>
                  <td className="p-2 border-b text-right">
                    {isNumberLike(success_pct) ? `${Math.round(Number(success_pct))}%` : "—"}
                  </td>
                  <td className="p-2 border-b text-right">{fmtNum(p95_s)}</td>
                  <td className="p-2 border-b text-right">
                    {isNumberLike(cost_usd) ? `$${fmtNum(cost_usd)}` : "—"}
                  </td>
                </tr>
              );
            })}
          </tbody>
        </table>

        {/* Table footer: count/limit/offset + pagination controls */}
        <div className="mt-2 flex flex-wrap items-center gap-2 text-sm text-gray-700">
          <span>count: {meta?.total ?? meta?.count ?? 0}</span>
          <span>•</span>
          <span>limit:</span>
          <select
            className="border rounded px-2 py-1"
            value={limit}
            onChange={(e) => {
              const next = Number(e.target.value);
              // Reset to page 1 on size change
              fetchAgents(0, next);
            }}
          >
            <option value={10}>10</option>
            <option value={25}>25</option>
            <option value={50}>50</option>
          </select>
          <span>•</span>
          <span>offset: {offset}</span>
          <div className="ml-auto flex items-center gap-2">
            <button
              className="px-2 py-1 border rounded disabled:opacity-50"
              disabled={!canPrev}
              onClick={() => fetchAgents(Math.max(0, offset - limit), limit)}
            >
              ← Prev
            </button>
            <button
              className="px-2 py-1 border rounded disabled:opacity-50"
              disabled={!canNext}
              onClick={() => fetchAgents(offset + limit, limit)}
            >
              Next →
            </button>
          </div>
        </div>

        {/* Summary of Findings (badges + bullets) */}
        <SummaryCard meta={payload.meta} />
      </div>
    );
  };

  return (
    <div className="rounded-2xl border p-4 space-y-3">
      {/* Header */}
      <div className="flex items-center justify-between gap-3">
        <h3 className="text-lg font-semibold">DTH Copilot</h3>
        {admin && gptUrl ? (
          <div className="flex items-center gap-2">
            <input readOnly className="border px-2 py-1 rounded w-72" value={gptUrl} />
            <button className="px-2 py-1 border rounded" onClick={() => navigator.clipboard.writeText(gptUrl)}>
              Copy GPT link
            </button>
          </div>
        ) : null}
      </div>

      {/* Controls */}
      <div className="flex flex-wrap items-center gap-2">
        <button className="px-3 py-1 border rounded" onClick={() => run("smokeTest")}>
          Smoke Test
        </button>
        <button className="px-3 py-1 border rounded" onClick={() => fetchAgents(0, limit)}>
          Agents
        </button>
        <button className="px-3 py-1 border rounded" onClick={() => fetchAgents(0, 25)}>
          Agents (25)
        </button>
        <button className="px-3 py-1 border rounded" onClick={() => fetchAgents(0, 50)}>
          Agents (50)
        </button>
        <button className="px-3 py-1 border rounded" onClick={() => fetchAgents(0, limit, { q: "router" })}>
          Search “router”
        </button>
        <button className="px-3 py-1 border rounded" onClick={() => fetchRoles(0, limit)}>
          Roles
        </button>
        <button
          className="px-3 py-1 border rounded"
          onClick={async () => {
            const handle = prompt("Role handle (e.g., product_owner)")?.trim();
            if (!handle) return;
            await run("getRoleByHandle", { handle });
          }}
        >
          Role by handle…
        </button>
      </div>

      {/* Results */}
      {err && <div className="text-red-600 text-sm">{err}</div>}

      {/* Table output */}
      {(out as TableOut)?.type === "table" && renderTable(out as TableOut)}

      {/* Smoke Test output */}
      {out && "result" in (out as SmokeOut) && (
        <div className="text-sm rounded-xl border p-3 space-y-2">
          <div className="flex items-center gap-2">
            <b>Smoke Test:</b>
            <Badge tone={(out as SmokeOut).result === "Green" ? "green" : "amber"}>
              {(out as SmokeOut).result}
            </Badge>
          </div>
          {(out as SmokeOut).summary ? (
            <div className="text-gray-800">{(out as SmokeOut).summary}</div>
          ) : null}
          <pre className="mt-1 bg-gray-50 p-2 rounded overflow-auto">
            {JSON.stringify((out as SmokeOut).diagnostics, null, 2)}
          </pre>
        </div>
      )}

      {/* Single JSON item (role-by-handle) */}
      {(out as JsonOut)?.type === "json" && (
        <pre className="text-xs bg-gray-50 p-2 rounded overflow-auto">
          {JSON.stringify((out as JsonOut).item, null, 2)}
        </pre>
      )}
    </div>
  );
}
```

**What this gives you:**

* Clean table with right-aligned numeric columns and badges for `level`/`status`.
* Real pagination (limit selector + Prev/Next computed from `X-Total-Count`/`meta.total`).
* A **Summary of Findings** card below any table when `meta.summary` is present:

  * Badges for Low/Medium/High counts
  * One-line overall summary
  * Key stats line
  * Bullet lists for **Top risks** and **Next actions**
  * Diagnostics line (if any)

No other files required—this integrates directly with your existing `/copilot/ask` outputs (including the summary patch you just added).
