This patch tries the likely endpoints in order and only requires DRIVE_STEWARD_URL + DRIVE_STEWARD_TOKEN.

FILE: tools/publish_drive_steward.ts (PATCH — replace main() publish section)
Replace the part where you set PUBLISH_PATH and build url with this:

const override = process.env.DRIVE_STEWARD_PUBLISH_PATH?.trim();

// Try override first (if set), otherwise try common known endpoints
const candidatePaths = [
  ...(override ? [override] : []),
  "/api/exports/publish",
  "/api/exports/push",
];

function runCurl(url: string, tarPath: string, manifestPath: string, token: string) {
  const cmd = [
    `curl -sS -w "\\n__HTTP_CODE__:%{http_code}\\n" -X POST "${url}"`,
    `-H "Authorization: Bearer ${token}"`,
    `-F "bundle=@${tarPath}"`,
    `-F "manifest=@${manifestPath}"`,
  ].join(" ");

  const out = execSync(cmd, { stdio: ["ignore", "pipe", "pipe"] }).toString("utf8");
  const m = out.match(/__HTTP_CODE__:(\d{3})\s*$/);
  const code = m ? Number(m[1]) : 0;
  const body = out.replace(/__HTTP_CODE__:\d{3}\s*$/, "").trim();
  return { code, body };
}

// ...

let last: { code: number; body: string } | null = null;

for (const p of candidatePaths) {
  const url = `${DRIVE_STEWARD_URL}${p.startsWith("/") ? "" : "/"}${p}`;
  console.log(`Publishing to Drive Steward (attempt): ${url}`);

  last = runCurl(url, tarPath, manifestPath, DRIVE_STEWARD_TOKEN);

  // Success
  if (last.code >= 200 && last.code < 300) {
    console.log(last.body);
    console.log(`✅ Publish succeeded via path: ${p}`);
    return;
  }

  // If not found, try next candidate
  if (last.code === 404) {
    console.log(`Path not found (404): ${p} — trying next...`);
    continue;
  }

  // Other errors: stop and show response
  console.error(`Publish failed (HTTP ${last.code}) via path: ${p}`);
  console.error(last.body);
  process.exit(1);
}

console.error("Publish failed. No candidate endpoint succeeded.");
if (last) {
  console.error(`Last HTTP ${last.code}`);
  console.error(last.body);
}
console.error(
  "If Drive Steward uses a different publish route, set DRIVE_STEWARD_PUBLISH_PATH explicitly."
);
process.exit(1);
Result
* If Drive Steward uses /api/exports/publish → works
* If it uses /api/exports/push → works
* If it’s something else → you set DRIVE_STEWARD_PUBLISH_PATH once and you’re done

DoD Verification (DreamTeamHub)

PROJECT_KEY=DreamTeamHub npm run export:bundle
PROJECT_KEY=DreamTeamHub DRIVE_STEWARD_URL=... DRIVE_STEWARD_TOKEN=... npm run publish:drive-steward
Then check in VSuite HQ (your ops cockpit):
* /publish-history (once we add DreamTeamHub into the project list there later)









