# Staging Environment Configuration Template
# Copy this to .env.staging and fill in your staging-specific values

# ======================================
# ENVIRONMENT
# ======================================
NODE_ENV=staging

# ======================================
# AUTHENTICATION & SECURITY
# ======================================

# Admin API Key (generate new random token for staging)
# This is used for admin endpoints like /api/admin/deploy/mark
DTH_API_TOKEN=REPLACE_WITH_STAGING_API_TOKEN

# Session encryption secret (generate new random secret for staging)
SESSION_SECRET=REPLACE_WITH_STAGING_SESSION_SECRET

# Basic Auth for staging site (protects entire application)
# Leave blank to disable basic auth
STAGING_AUTH_USER=staging
STAGING_AUTH_PASS=REPLACE_WITH_STAGING_PASSWORD

# ======================================
# DATABASE
# ======================================

# IMPORTANT: Use separate staging database, NEVER production!
# PostgreSQL connection string (Neon or other provider)
DATABASE_URL=postgresql://user:pass@staging-db.yourdomain.com:5432/dreamteamhub_staging

# ======================================
# REDIS (Optional - for ops logs streaming)
# ======================================

# Redis connection for real-time logs streaming
# Leave blank to use in-memory buffer fallback
REDIS_URL=redis://staging-redis.yourdomain.com:6379

# Optional: Redis channel for ops logs
OPS_LOGS_CHANNEL=ops:logs:staging

# ======================================
# AWS S3 STORAGE
# ======================================

# IMPORTANT: Use staging bucket or staging prefix, NEVER production bucket!
AWS_S3_BUCKET=dreamteamhub-staging
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=REPLACE_WITH_STAGING_AWS_KEY
AWS_SECRET_ACCESS_KEY=REPLACE_WITH_STAGING_AWS_SECRET

# Optional: S3 key prefix for isolation
S3_KEY_PREFIX=staging/

# ======================================
# SMTP / EMAIL
# ======================================

# IMPORTANT: Use test SMTP service, NEVER production SMTP!
# Recommended: Mailtrap.io, Mailhog, or other test SMTP service
SMTP_HOST=smtp.mailtrap.io
SMTP_PORT=587
SMTP_USER=REPLACE_WITH_TEST_SMTP_USER
SMTP_PASS=REPLACE_WITH_TEST_SMTP_PASS
SMTP_FROM=staging@yourdomain.com

# Optional: SMTP TLS settings
SMTP_SECURE=false

# ======================================
# HEALTH CHECK CONFIGURATION
# ======================================

# Health check probe timeout (5000ms = 5 seconds)
HEALTHZ_PROBE_TIMEOUT_MS=5000

# Global health check cap (2500ms = 2.5 seconds)
HEALTHZ_GLOBAL_CAP_MS=2500

# Health check cache TTL (60000ms = 60 seconds)
HEALTHZ_CACHE_TTL_MS=60000

# ======================================
# ALERTS & NOTIFICATIONS
# ======================================

# IMPORTANT: Route to test Slack channels, NOT production channels!
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/STAGING/WEBHOOK

# IMPORTANT: Route to test PagerDuty service, NOT production!
PAGERDUTY_INTEGRATION_KEY=REPLACE_WITH_STAGING_PAGERDUTY_KEY

# Optional: Alert throttling (seconds between duplicate alerts)
ALERT_THROTTLE_SECONDS=300

# ======================================
# OPENAI (LLM Services)
# ======================================

# OpenAI API key (can use same as prod or separate staging key)
OPENAI_API_KEY=REPLACE_WITH_OPENAI_API_KEY

# Optional: Use different model for staging
OPENAI_MODEL=gpt-4

# ======================================
# GOOGLE DRIVE (Knowledge Management)
# ======================================

# Google Drive API credentials (can use same as prod or separate)
GOOGLE_CLIENT_ID=REPLACE_WITH_GOOGLE_CLIENT_ID
GOOGLE_CLIENT_SECRET=REPLACE_WITH_GOOGLE_CLIENT_SECRET
GOOGLE_REDIRECT_URI=https://staging.yourdomain.com/auth/google/callback

# ======================================
# REPLIT AUTH (If using Replit deployment)
# ======================================

# Replit Auth OIDC configuration
REPLIT_AUTH_CLIENT_ID=REPLACE_WITH_REPLIT_CLIENT_ID
REPLIT_AUTH_CLIENT_SECRET=REPLACE_WITH_REPLIT_CLIENT_SECRET

# ======================================
# DEPLOYMENT & MONITORING
# ======================================

# Application base URL
APP_BASE_URL=https://staging.yourdomain.com

# Optional: Sentry DSN for error tracking
SENTRY_DSN=REPLACE_WITH_SENTRY_DSN
SENTRY_ENVIRONMENT=staging

# Optional: DataDog API key for monitoring
DATADOG_API_KEY=REPLACE_WITH_DATADOG_API_KEY

# ======================================
# FEATURE FLAGS (Optional)
# ======================================

# Enable/disable features for staging testing
FEATURE_WORK_ORDERS_ENABLED=true
FEATURE_BRAINSTORM_STUDIO_ENABLED=true
FEATURE_DREAM_TEAM_CHAT_ENABLED=true

# ======================================
# RATE LIMITING
# ======================================

# Rate limit windows (requests per minute)
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# Specific endpoint rate limits
DEPLOY_MARK_RATE_LIMIT=10
LOGS_EMIT_RATE_LIMIT=30

# ======================================
# STAGING-SPECIFIC SETTINGS
# ======================================

# Reduced resource limits for staging
MAX_UPLOAD_SIZE_MB=10
MAX_CONCURRENT_JOBS=2
WORKER_POOL_SIZE=2

# Verbose logging for debugging
LOG_LEVEL=debug
ENABLE_REQUEST_LOGGING=true

# Data retention (shorter for staging)
LOGS_RETENTION_DAYS=7
EVENTS_RETENTION_DAYS=14

# ======================================
# NOTES
# ======================================

# Remember to:
# 1. Never use production credentials in staging
# 2. Use test/sandbox versions of all external services
# 3. Route all alerts to test channels (Slack, PagerDuty)
# 4. Use separate databases and storage buckets
# 5. Rotate staging tokens quarterly
# 6. Clean up staging data weekly
# 7. Document any staging-specific configurations

# For more information, see:
# - docs/ops/STAGING_SETUP.md
# - docs/ops/STAGING_TESTING_CHECKLIST.md
# - docs/ops/env_matrix.md
